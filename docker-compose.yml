services:
  qbittorrent-cleaner:
    build: .
    container_name:   qbittorrent-cleaner:
    restart: unless-stopped
    environment:
      - QBIT_HOST=http://qbittorrent:8080
      - QBIT_USER=admin
      - QBIT_PASS=adminadmin
      
      # --- THE COMPLEX LOGIC ---
      # Format: Category | Logical Expression
      # Units: time (seconds), ratio (decimal), uploaded/size (bytes)
      
      # Example Rules Explained:
      # 1. radarr: Delete if older than 7 days AND (Ratio > 2.0 OR Uploaded > 20GB)
      # 2. sonarr: Delete if (older than 2 days AND Ratio > 1.0) OR (older than 10 days regardless of ratio)
      # 3. music:  Delete if Ratio > 5.0 (ignoring time)
      
      - PURGE_RULES=radarr | time > 604800 and (ratio > 2.0 or uploaded > 21474836480), sonarr | (time > 172800 and ratio > 1.0) or time > 864000, music | ratio > 5.0
      
      - DELETE_FILES=true
      - CHECK_INTERVAL=3600
      - DRY_RUN=true
